<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Report</title>
    <link rel="icon" type="image/png" href="./images/cloudy-day.png">
    <link rel="stylesheet" href="./styles.css">
</head>

<body>
    <div class="card">
        <div class="search">
            <input type="text" placeholder="Enter City Name" spellcheck="false">
            <!-- Disables the browser’s built-in spell checker. if spellcheck=true the browser might underline misspelled words as the user types. -->
            <button><img src="./images/search.png"></button>
        </div>
        <div class="error">
            <p>Invalid City Name</p>
        </div>
        <div class="weather">
            <img src="./images/rain.png" class="weather-icon">
            <h1 class="temp">22°c</h1>
            <h2 class="city">New York</h2>
            <div class="details">
                <div class="col">
                    <img src="./images/humidity.png">
                    <div>
                        <p class="humidity">50%</p>
                        <p>Humidity</p>
                    </div>
                </div>
                <div class="col">
                    <img src="./images/wind.png">
                    <div>
                        <p class="wind">10 km/h</p>
                        <p>Wind Speed</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        const apiKey = "be693b419e087614d8c0d805dbb0817d"
        const apiUrl = "https://api.openweathermap.org/data/2.5/weather?units=metric&q="

        const searchBox = document.querySelector(".search input");
        const searchBtn = document.querySelector(".search button");
        const weatherIcon = document.querySelector(".weather-icon");

        async function checkWeather(city) {  //The async keyword is used to declare an asynchronous function. When you add async before a function declaration, it tells the JavaScript engine that the function will return a Promise
            const response = await fetch(apiUrl + city + `&appid=${apiKey}`);  //When you use await on a Promise, the JavaScript engine suspends the execution of the async function and moves on to other tasks in the event loop. Once the awaited Promise is resolved (e.g., the API call returns a response), the async function resumes from where it left off  
            if (response.status == 404) {
                document.querySelector(".error").style.display = "block";
                document.querySelector(".weather").style.display = "none";
            }
            else {
                let data = await response.json();

                document.querySelector(".temp").innerHTML = Math.round(data.main.temp) + "°c";
                document.querySelector(".city").innerHTML = data.name;
                document.querySelector(".humidity").innerHTML = data.main.humidity + "%";
                document.querySelector(".wind").innerHTML = data.wind.speed + " km/h";

                if (data.weather[0].main == "Clouds") {
                    weatherIcon.src = "/images/clouds.png" // if the value changes then the image will change
                }
                else if (data.weather[0].main == "Rain") {
                    weatherIcon.src = "/images/Rain.png"
                }
                else if (data.weather[0].main == "Mist") {
                    weatherIcon.src = "/images/mist.png"
                }
                else if (data.weather[0].main == "Clear") {
                    weatherIcon.src = "/images/clear.png"
                }
                else if (data.weather[0].main == "Humidity") {
                    weatherIcon.src = "/images/humidity.png"
                }
                else if (data.weather[0].main == "Snow") {
                    weatherIcon.src = "/images/snow.png"
                }
                document.querySelector(".error").style.display = "none";  // to not show the content
                document.querySelector(".weather").style.display = "block";  // to show the content
            }
        }

        searchBtn.addEventListener("click", () => {  // once the search button is clicked 'city' value will be passed to function
            checkWeather(searchBox.value)
        })

    </script>
</body>

</html>